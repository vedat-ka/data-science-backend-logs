<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ML Log Analyzer</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="header">
        <div>
          <h1>ML Log Analyzer</h1>
          <p class="subtitle">Logs aus Datei analysieren und Ergebnisse anzeigen</p>
        </div>
        <div class="status" id="healthStatus">Backend: lädt...</div>
      </header>

      <div class="panel-grid panel-grid-wide">
        <section class="panel">
          <h2>Raw-Logs laden und atomisieren</h2>
          <div class="controls">
            <select id="rawSelect"></select>
            <input id="outPath" type="text" placeholder="z.B. logs_from_raw.jsonl" />
            <button id="reloadRaw">Raw-Dateien neu laden</button>
            <button class="primary" id="atomizeBtn">Atomisieren</button>
          </div>
          <div class="controls">
            <input id="uploadFileInput" type="file" accept=".jsonl,.json,.log,.txt,.html" />
            <button id="uploadFileBtn">Datei hochladen</button>
          </div>
          <div class="hint">Erstellt aus .txt/.log eine JSONL-Datei im Ordner <strong>data/</strong>. Uploads werden ebenfalls in <strong>data/</strong> gespeichert und im Popup angezeigt.</div>
        </section>

        <section class="panel">
          <h2>Trainieren</h2>
          <div class="controls">
            <select id="trainSelect"></select>
            <button id="reloadTrain">Trainingsdateien neu laden</button>
            <button class="primary" id="trainBtn">Training starten</button>
          </div>
          <div class="hint">Trainiert Modelle aus einer JSONL-Datei in <strong>data/</strong>.</div>
        </section>
      </div>

      <div class="panel-grid panel-grid-wide">
        <section class="panel">
          <h2>Analysieren</h2>
          <div class="controls">
            <select id="fileSelect"></select>
            <button id="reloadFiles">Dateien neu laden</button>
            <button class="primary" id="analyzeBtn">Analysieren</button>
          </div>
          <div class="hint">Es werden Dateien aus dem Ordner <strong>data/</strong> verwendet.</div>
        </section>

        <section class="panel">
          <h2>Training-Reports</h2>
          <div class="controls">
            <select id="reportSelect"></select>
            <button id="reloadReports">Reports neu laden</button>
            <button class="primary" id="openReport">Report öffnen</button>
          </div>
          <div class="hint">Gespeicherte Reports aus <strong>training/</strong> anzeigen.</div>
        </section>
      </div>

      <div class="panel-grid panel-grid-wide">
        <section class="panel">
          <h2>Analyse-Reports</h2>
          <div class="controls">
            <select id="analysisSelect"></select>
            <button id="reloadAnalysis">Reports neu laden</button>
            <button class="primary" id="openAnalysis">Report öffnen</button>
          </div>
          <div class="hint">Gespeicherte Reports aus <strong>analysis/</strong> anzeigen.</div>
        </section>

        <section class="panel">
          <h2>Dateien splitten (max 4 MB)</h2>
          <div class="controls">
            <select id="splitSelect"></select>
            <input id="splitMaxMb" type="number" min="1" step="0.5" value="4" />
            <button id="reloadSplit">Dateien neu laden</button>
            <button class="primary" id="splitBtn">Splitten</button>
          </div>
          <div class="hint">Erstellt mehrere JSONL-Dateien in <strong>data/</strong> mit max. 4 MB.</div>
        </section>
      </div>

      <section class="panel">
        <h2>Ergebnisse</h2>
        <div class="summary" id="summary"></div>
        <div class="stats" id="stats"></div>
        <div class="section-label">Tabelle</div>
        <div class="filters" id="filters">
          <select id="levelFilter">
            <option value="">Level: alle</option>
            <option value="CRITICAL">CRITICAL</option>
            <option value="ERROR">ERROR</option>
            <option value="WARN">WARN</option>
            <option value="INFO">INFO</option>
          </select>
          <select id="priorityFilter">
            <option value="">Priority: alle</option>
            <option value="critical">critical</option>
            <option value="high">high</option>
            <option value="medium">medium</option>
            <option value="low">low</option>
          </select>
          <input id="searchFilter" type="text" placeholder="Suche (z.B. FATALER STARTFEHLER)" />
          <button id="clearFilters">Filter löschen</button>
        </div>
        <div class="table-controls">
          <label>
            Gruppierung
            <select id="groupBy">
              <option value="priority">Priorität</option>
              <option value="none">Keine</option>
            </select>
          </label>
          <div class="pager">
            <button id="prevPage">Zurück</button>
            <span id="pageInfo">Seite 1</span>
            <button id="nextPage">Weiter</button>
          </div>
        </div>
        <div class="table-wrapper">
          <table id="resultsTable">
            <thead>
              <tr>
                <th>#</th>
                <th>Message</th>
                <th>Level</th>
                <th>Service</th>
                <th>Route</th>
                <th>Status</th>
                <th>Kategorie</th>
                <th>Priorität</th>
                <th>Grund</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </div>

    <div class="modal" id="trainModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTitle">Report</h3>
          <button id="closeModal">Schließen</button>
        </div>
        <pre id="trainModalBody"></pre>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
